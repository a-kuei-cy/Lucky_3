<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Âπ∏ÈÅãÂ§ßËΩâÁõ§</title>
    
    <!-- ÂºïÂÖ• React, ReactDOM, Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- ÂºïÂÖ• Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
      body { font-family: 'Noto Sans TC', sans-serif; }
      input[type=number]::-webkit-inner-spin-button, 
      input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // =================================================================
      // ‚ö†Ô∏è Ë´ãÂú®Ê≠§ËôïË≤º‰∏äÊÇ®ÁöÑ Google Apps Script ÈÉ®ÁΩ≤Á∂≤ÂùÄ
      // ‰æãÂ¶Ç: https://script.google.com/macros/s/AKfycbx.../exec
      // =================================================================
      const GAS_API_URL = "https://script.google.com/macros/s/AKfycbzgxuAajeQgaDxmI06uF8zotDKEvbuNw_xo-Nyo2sXvyAEQl1a2b2dnnJEYAmgbaAEn/exec"; 

      // ---------------------------------------------------------
      // üì° API ÈÄöË®äÂ±§ (Âèñ‰ª£ google.script.run)
      // ---------------------------------------------------------
      const api = {
        call: async (action, payload = {}) => {
          // Â¶ÇÊûúÊ≤íÊúâÂ°´Á∂≤ÂùÄÔºå‰ΩøÁî®Ê®°Êì¨Êï∏Êìö (ÈÅøÂÖçÂ†±ÈåØ)
          if (GAS_API_URL.includes("ÊÇ®ÁöÑ_WEB_APP_URL")) {
            console.warn("Â∞öÊú™Ë®≠ÂÆö API URLÔºå‰ΩøÁî®Ê®°Êì¨Ê®°Âºè");
            return mockApi(action, payload);
          }

          try {
            // ‰ΩøÁî® fetch ÁôºÈÄÅ POST Ë´ãÊ±Ç
            // Google Apps Script Web App È†êË®≠ÊúÉËôïÁêÜ CORS ÈáçÂ∞éÂêëÔºåfetch ÊúÉËá™ÂãïË∑üÈö®
            const response = await fetch(GAS_API_URL, {
              method: "POST",
              // ‰ΩøÁî® text/plain ÂèØ‰ª•ÈÅøÂÖçÊüê‰∫õÁÄèË¶ΩÂô®ÁöÑ CORS È†êÊ™¢Ë´ãÊ±Ç (Preflight) ÂïèÈ°å
              headers: { "Content-Type": "text/plain;charset=utf-8" },
              body: JSON.stringify({ action, ...payload })
            });
            const data = await response.json();
            return data;
          } catch (error) {
            console.error("API Error:", error);
            throw new Error("ÈÄ£Á∑öÂ§±ÊïóÔºåË´ãÊ™¢Êü•Á∂≤Ë∑ØÊàñ API Á∂≤ÂùÄ");
          }
        }
      };

      // Ê®°Êì¨ API (Áï∂‰ΩøÁî®ËÄÖÂøòË®òÂ°´ URL ÊôÇ‰ΩøÁî®)
      const mockApi = (action, payload) => {
         return new Promise((resolve) => {
            setTimeout(() => {
                if (action === 'getPrizes') resolve([
                    {id:1, name:"(Ë´ãË®≠ÂÆöAPIÁ∂≤ÂùÄ)", quantity:1, color:"#ddd"},
                    {id:2, name:"GitHubÊ®°Âºè", quantity:5, color:"#eee"}
                ]);
                else if (action === 'checkAdminPassword') resolve({ isValid: true });
                else resolve({ status: "success", winnerId: 1, remaining: 0 });
            }, 500);
         });
      }

      // ---------------------------------------------------------
      // üé® ÂúñÊ®ôÁµÑ‰ª∂ (Icons)
      // ---------------------------------------------------------
      const IconBase = ({ children, className, ...props }) => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>);
      const Settings = (props) => (<IconBase {...props}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></IconBase>);
      const Plus = (props) => (<IconBase {...props}><path d="M5 12h14" /><path d="M12 5v14" /></IconBase>);
      const Trash2 = (props) => (<IconBase {...props}><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" x2="10" y1="11" y2="17" /><line x1="14" x2="14" y1="11" y2="17" /></IconBase>);
      const X = (props) => (<IconBase {...props}><path d="M18 6 6 18" /><path d="m6 6 12 12" /></IconBase>);
      const Save = (props) => (<IconBase {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" /><polyline points="17 21 17 13 7 13 7 21" /><polyline points="7 3 7 8 15 8" /></IconBase>);
      const RefreshCw = (props) => (<IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" /><path d="M8 16H3v5" /></IconBase>);
      const Gift = (props) => (<IconBase {...props}><polyline points="20 12 20 22 4 22 4 12" /><rect width="20" height="5" x="2" y="7" /><line x1="12" x2="12" y1="22" y2="7" /><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z" /><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z" /></IconBase>);
      const Trophy = (props) => (<IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" /><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /></IconBase>);
      const Loader2 = (props) => (<IconBase {...props}><path d="M21 12a9 9 0 1 1-6.219-8.56" /></IconBase>);
      const Lock = (props) => (<IconBase {...props}><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></IconBase>);

      function App() {
        const [prizes, setPrizes] = useState([]);
        const [loading, setLoading] = useState(true);
        const [isSpinning, setIsSpinning] = useState(false);
        const [winner, setWinner] = useState(null);
        const [rotation, setRotation] = useState(0);
        
        // Admin
        const [showLoginModal, setShowLoginModal] = useState(false);
        const [showAdminModal, setShowAdminModal] = useState(false);
        const [passwordInput, setPasswordInput] = useState("");
        const [loginError, setLoginError] = useState("");
        const [editingPrizes, setEditingPrizes] = useState([]);
        const [isSaving, setIsSaving] = useState(false);

        const canvasRef = useRef(null);

        // Fetch Data using new API
        const fetchPrizes = async () => {
          setLoading(true);
          try {
            const data = await api.call('getPrizes');
            if (Array.isArray(data)) {
              setPrizes(data);
              setEditingPrizes(JSON.parse(JSON.stringify(data)));
            }
          } catch (e) {
            alert(e.message);
          } finally {
            setLoading(false);
          }
        };

        useEffect(() => {
          fetchPrizes();
        }, []);

        // Canvas Logic
        const activePrizes = prizes.filter(p => p.quantity > 0);
        const displayPrizes = activePrizes.length > 0 ? activePrizes : [];

        useEffect(() => {
          const canvas = canvasRef.current;
          if (!canvas) return;
          const ctx = canvas.getContext('2d');
          const width = canvas.width;
          const height = canvas.height;
          const centerX = width / 2;
          const centerY = height / 2;
          const radius = width / 2 - 10;

          ctx.clearRect(0, 0, width, height);

          if (displayPrizes.length === 0) {
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.fillStyle = '#e2e8f0';
            ctx.fill();
            ctx.fillStyle = '#94a3b8';
            ctx.font = '24px sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(loading ? "ËÆÄÂèñ‰∏≠..." : "ÁçéÈ†ÖÂ∑≤Á©∫", centerX, centerY);
            return;
          }

          const arcSize = (2 * Math.PI) / displayPrizes.length;

          displayPrizes.forEach((prize, index) => {
            const startAngle = index * arcSize - Math.PI / 2;
            const endAngle = startAngle + arcSize;

            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.arc(centerX, centerY, radius, startAngle, endAngle);
            ctx.fillStyle = prize.color;
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = "#ffffff";
            ctx.stroke();

            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(startAngle + arcSize / 2);
            ctx.textAlign = "right";
            ctx.fillStyle = "#fff";
            ctx.shadowColor = "rgba(0,0,0,0.5)";
            ctx.shadowBlur = 4;
            ctx.font = "bold 18px sans-serif";
            ctx.fillText(prize.name.substring(0, 8), radius - 20, 5);
            ctx.font = "12px sans-serif";
            ctx.fillText(`(Ââ©${prize.quantity})`, radius - 20, 24);
            ctx.restore();
          });
        }, [prizes, loading, displayPrizes.length]);

        // Spin Logic
        const handleSpin = async () => {
          if (isSpinning || displayPrizes.length === 0) return;
          setIsSpinning(true);
          setWinner(null);

          try {
            const result = await api.call('runLottery');
            
            if (result.error) {
              alert(result.message);
              fetchPrizes();
              return;
            }
            performSpinAnimation(result);
          } catch (e) {
            alert(e.message);
            setIsSpinning(false);
          }
        };

        const performSpinAnimation = (serverResult) => {
          const { winnerId } = serverResult;
          const winnerIndex = displayPrizes.findIndex(p => p.id == winnerId);
          
          if (winnerIndex === -1) {
             fetchPrizes();
             setIsSpinning(false);
             return;
          }

          const sliceAngle = 360 / displayPrizes.length;
          const padding = Math.max(sliceAngle * 0.1, 5);
          const randomOffset = padding + Math.random() * (sliceAngle - 2 * padding);
          
          const angleFromStart = (winnerIndex * sliceAngle) + randomOffset;
          const targetAngleOnCircle = (360 - angleFromStart) % 360;
          
          const currentAngleMod = rotation % 360;
          let distance = targetAngleOnCircle - currentAngleMod;
          if (distance < 0) distance += 360;
          
          const extraSpins = 360 * 5; 
          const newRotation = rotation + extraSpins + distance;

          setRotation(newRotation);

          setTimeout(() => {
            setIsSpinning(false);
            setPrizes(prev => prev.map(p => p.id == winnerId ? { ...p, quantity: serverResult.remaining } : p));
            setWinner({ ...displayPrizes[winnerIndex], quantity: serverResult.remaining });
            fetchPrizes(); 
          }, 4500);
        };

        // Admin Logic
        const handleAdminClick = () => {
          if (isSpinning) return;
          setPasswordInput("");
          setLoginError("");
          setShowLoginModal(true);
        };

        const handleLoginSubmit = async (e) => {
          e.preventDefault();
          try {
            const res = await api.call('checkAdminPassword', { password: passwordInput });
            if (res.isValid) {
              setShowLoginModal(false);
              setEditingPrizes(JSON.parse(JSON.stringify(prizes))); 
              setShowAdminModal(true);
            } else {
              setLoginError("ÂØÜÁ¢ºÈåØË™§ÔºåË´ãÈáçË©¶");
            }
          } catch(e) {
            setLoginError("ÈÄ£Á∑öÈåØË™§");
          }
        };

        const handleEditPrize = (id, field, value) => {
          setEditingPrizes(prev => prev.map(p => 
            p.id === id ? { ...p, [field]: value } : p
          ));
        };

        const handleAddPrize = () => {
          const newId = Date.now();
          const colors = ["#FF6B6B", "#4ECDC4", "#FFE66D", "#1A535C", "#FF9F1C", "#2EC4B6", "#FF006E"];
          const randomColor = colors[Math.floor(Math.random() * colors.length)];
          setEditingPrizes([...editingPrizes, {
            id: newId,
            name: "Êñ∞ÁçéÈ†Ö",
            quantity: 1,
            color: randomColor
          }]);
        };

        const handleDeletePrize = (id) => {
          if (editingPrizes.length <= 1) {
            alert("Ëá≥Â∞ëÈúÄ‰øùÁïô‰∏ÄÂÄãÁçéÈ†Ö");
            return;
          }
          if(confirm("Á¢∫ÂÆöÂà™Èô§Ê≠§ÁçéÈ†ÖÔºü")) {
            setEditingPrizes(prev => prev.filter(p => p.id !== id));
          }
        };

        const handleSaveAdmin = async () => {
          setIsSaving(true);
          try {
             const res = await api.call('saveAllPrizes', { data: editingPrizes });
             if (res.status === 'success') {
                setShowAdminModal(false);
                fetchPrizes();
                alert("ÂÑ≤Â≠òÊàêÂäüÔºÅ");
             } else {
                alert("ÂÑ≤Â≠òÂ§±Êïó: " + res.error);
             }
          } catch(e) {
             alert(e.message);
          } finally {
             setIsSaving(false);
          }
        };

        return (
          <div className="min-h-screen bg-slate-100 text-slate-800 pb-10 flex flex-col items-center font-sans">
            <header className="w-full bg-slate-900 text-white p-4 shadow-md flex justify-between items-center sticky top-0 z-30">
              <div className="flex items-center gap-2">
                <Gift className="text-yellow-400" />
                <h1 className="text-xl font-bold tracking-wider hidden sm:block">Á∑ö‰∏äÂπ∏ÈÅãÊäΩÁçé</h1>
                <h1 className="text-xl font-bold tracking-wider sm:hidden">Âπ∏ÈÅãÊäΩÁçé</h1>
              </div>
              <button 
                onClick={handleAdminClick}
                disabled={isSpinning}
                className="flex items-center gap-2 px-3 py-1.5 bg-slate-800 hover:bg-slate-700 rounded-full transition-colors border border-slate-700 text-sm disabled:opacity-50"
              >
                <Settings className="w-4 h-4" />
                <span>ÁÆ°ÁêÜ</span>
              </button>
            </header>

            <main className="w-full max-w-lg p-4 flex flex-col items-center gap-8 mt-4">
              <div className="relative group w-[320px] h-[320px] sm:w-[380px] sm:h-[380px]">
                <div className="absolute -top-6 left-1/2 -translate-x-1/2 z-20 drop-shadow-lg">
                  <div className="w-0 h-0 border-l-[15px] border-l-transparent border-r-[15px] border-r-transparent border-t-[30px] border-t-red-600"></div>
                </div>
                <div 
                  className="w-full h-full rounded-full overflow-hidden bg-white border-4 border-white shadow-2xl relative z-10"
                  style={{
                    transform: `rotate(${rotation}deg)`,
                    transition: isSpinning ? 'transform 4.5s cubic-bezier(0.15, 0.85, 0.15, 1)' : 'none'
                  }}
                >
                  <canvas ref={canvasRef} width={500} height={500} className="w-full h-full" />
                </div>
                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-12 h-12 bg-white rounded-full shadow-md z-20 flex items-center justify-center border-2 border-slate-200">
                  <div className="w-6 h-6 bg-slate-800 rounded-full"></div>
                </div>
              </div>

              <div className="w-full px-8">
                 <button
                  onClick={handleSpin}
                  disabled={isSpinning || loading || displayPrizes.length === 0}
                  className={`w-full py-4 rounded-2xl text-2xl font-black tracking-widest shadow-lg transition-all transform active:scale-95 flex justify-center items-center gap-2
                    ${isSpinning || displayPrizes.length === 0 
                      ? 'bg-slate-300 text-slate-500 cursor-not-allowed' 
                      : 'bg-gradient-to-r from-red-500 to-orange-500 text-white hover:shadow-orange-500/50'
                    }`}
                >
                  {loading ? <Loader2 className="animate-spin" /> : isSpinning ? 'SPINNING...' : displayPrizes.length === 0 ? 'Ê¥ªÂãïÁµêÊùü' : 'GO!'}
                </button>
                <p className="text-center text-slate-500 text-sm mt-3">
                  Ââ©È§òÁçéÈ†ÖÁ∏ΩÊï∏: {displayPrizes.reduce((acc, curr) => acc + curr.quantity, 0)}
                </p>
              </div>

              <div className="w-full bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div className="bg-slate-50 px-4 py-3 border-b border-slate-200 font-bold text-slate-700 flex justify-between items-center">
                  <span>ÁçéÈ†ÖÊ∏ÖÂñÆ</span>
                  <button onClick={fetchPrizes} className="text-slate-400 hover:text-slate-600" title="ÈáçÊñ∞Êï¥ÁêÜ">
                    <RefreshCw className="w-4 h-4" />
                  </button>
                </div>
                <div className="divide-y divide-slate-100 max-h-60 overflow-y-auto">
                  {prizes.map(p => (
                    <div key={p.id} className={`flex justify-between items-center p-3 ${p.quantity === 0 ? 'bg-slate-50 opacity-50' : ''}`}>
                      <div className="flex items-center gap-3 overflow-hidden">
                        <span className="w-3 h-3 rounded-full flex-shrink-0" style={{backgroundColor: p.color}}></span>
                        <span className="font-medium truncate">{p.name}</span>
                      </div>
                      <span className={`text-xs px-2 py-1 rounded-full font-bold whitespace-nowrap ${p.quantity === 0 ? 'bg-slate-200 text-slate-500' : 'bg-green-100 text-green-700'}`}>
                        {p.quantity === 0 ? 'Â∑≤ÊäΩÂÆå' : `x${p.quantity}`}
                      </span>
                    </div>
                  ))}
                </div>
              </div>

            </main>

            {/* Login Modal */}
            {showLoginModal && (
              <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in">
                <div className="bg-white rounded-xl shadow-xl w-full max-w-sm p-6 animate-in zoom-in-95">
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-lg font-bold text-slate-800 flex items-center gap-2">
                      <Lock className="w-5 h-5 text-indigo-600" />
                      ÁÆ°ÁêÜËÄÖÁôªÂÖ•
                    </h3>
                    <button onClick={() => setShowLoginModal(false)} className="text-slate-400 hover:text-slate-600">
                      <X className="w-5 h-5" />
                    </button>
                  </div>
                  <form onSubmit={handleLoginSubmit}>
                    <div className="mb-4">
                      <label className="block text-sm font-medium text-slate-700 mb-1">Ë´ãËº∏ÂÖ•ÂØÜÁ¢º</label>
                      <input 
                        type="password" 
                        value={passwordInput}
                        onChange={(e) => setPasswordInput(e.target.value)}
                        className="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                        autoFocus
                      />
                      {loginError && <p className="text-red-500 text-xs mt-2">{loginError}</p>}
                    </div>
                    <button 
                      type="submit"
                      className="w-full bg-indigo-600 text-white py-2 rounded-lg font-bold hover:bg-indigo-700 transition-colors"
                    >
                      ÁôªÂÖ•
                    </button>
                  </form>
                </div>
              </div>
            )}

            {/* Admin Modal */}
            {showAdminModal && (
              <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in">
                <div className="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] flex flex-col animate-in zoom-in-95 overflow-hidden">
                  
                  <div className="p-4 border-b border-gray-100 flex justify-between items-center bg-slate-50">
                    <h2 className="font-bold text-slate-800 flex items-center gap-2">
                      <Settings className="w-5 h-5 text-indigo-600" />
                      ÂæåÂè∞ÁÆ°ÁêÜË®≠ÂÆö
                    </h2>
                    <button onClick={() => setShowAdminModal(false)} className="p-2 hover:bg-slate-200 rounded-full text-slate-500">
                      <X className="w-5 h-5" />
                    </button>
                  </div>

                  <div className="flex-1 overflow-y-auto p-4 space-y-3 bg-slate-50/30">
                    {editingPrizes.map((prize) => (
                      <div key={prize.id} className="flex flex-col sm:flex-row gap-2 bg-white p-3 rounded-xl border border-slate-200 shadow-sm">
                        <div className="flex items-center gap-2 flex-1">
                          <input 
                            type="color" 
                            value={prize.color}
                            onChange={(e) => handleEditPrize(prize.id, 'color', e.target.value)}
                            className="w-10 h-10 rounded-lg cursor-pointer border-0 bg-transparent p-0"
                            title="‰øÆÊîπÈ°èËâ≤"
                          />
                          <input 
                            type="text" 
                            value={prize.name}
                            onChange={(e) => handleEditPrize(prize.id, 'name', e.target.value)}
                            className="flex-1 px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 outline-none w-full"
                            placeholder="ÁçéÈ†ÖÂêçÁ®±"
                          />
                        </div>
                        <div className="flex items-center gap-2 justify-between sm:justify-end">
                          <div className="flex items-center bg-slate-100 rounded-lg px-2 border border-slate-200">
                            <span className="text-xs text-slate-500 mr-1">Êï∏</span>
                            <input 
                              type="number" 
                              min="0"
                              value={prize.quantity}
                              onChange={(e) => handleEditPrize(prize.id, 'quantity', parseInt(e.target.value) || 0)}
                              className="w-14 py-2 bg-transparent text-center font-bold text-indigo-600 outline-none"
                            />
                          </div>
                          <button 
                            onClick={() => handleDeletePrize(prize.id)} 
                            className="p-2.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors"
                            title="Âà™Èô§"
                          >
                            <Trash2 className="w-4 h-4" />
                          </button>
                        </div>
                      </div>
                    ))}
                    
                    <button 
                      onClick={handleAddPrize}
                      className="w-full py-3 border-2 border-dashed border-indigo-200 text-indigo-500 rounded-xl hover:bg-indigo-50 flex items-center justify-center gap-2 font-bold transition-all mt-2"
                    >
                      <Plus className="w-4 h-4" /> Êñ∞Â¢ûÁçéÈ†Ö
                    </button>
                  </div>

                  <div className="p-4 border-t border-slate-100 bg-white flex justify-end gap-3">
                    <button 
                      onClick={() => setShowAdminModal(false)} 
                      className="px-4 py-2 text-slate-500 hover:bg-slate-100 rounded-lg transition-colors font-medium"
                    >
                      ÂèñÊ∂à
                    </button>
                    <button 
                      onClick={handleSaveAdmin} 
                      disabled={isSaving}
                      className="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-bold shadow-md active:scale-95 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
                    >
                      {isSaving ? <Loader2 className="w-4 h-4 animate-spin" /> : <Save className="w-4 h-4" />}
                      ÂÑ≤Â≠òËÆäÊõ¥
                    </button>
                  </div>
                </div>
              </div>
            )}

            {winner && (
              <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-in fade-in">
                <div className="bg-white rounded-2xl p-8 max-w-sm w-full text-center relative animate-in zoom-in-95 border-4 border-yellow-400">
                  <div className="absolute -top-10 left-1/2 -translate-x-1/2">
                    <div className="bg-yellow-100 p-4 rounded-full border-4 border-white shadow-lg animate-bounce">
                      <Trophy className="w-10 h-10 text-yellow-600" />
                    </div>
                  </div>
                  
                  <div className="mt-8">
                    <h2 className="text-2xl font-bold mb-2 text-slate-800">ÊÅ≠ÂñúÁç≤ÂæóÔºÅ</h2>
                    <div className="py-4 px-2 bg-slate-50 rounded-xl mb-4 border border-slate-100">
                      <div className="text-3xl font-black break-words" style={{color: winner.color}}>
                        {winner.name}
                      </div>
                      <p className="text-slate-400 text-xs mt-2">Â∫´Â≠òÂâ©È§ò: {winner.quantity}</p>
                    </div>
                    <button 
                      onClick={() => setWinner(null)}
                      className="w-full bg-slate-900 text-white py-3 rounded-xl font-bold shadow-lg hover:scale-105 transition-transform"
                    >
                      Â§™Ê£í‰∫Ü
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
